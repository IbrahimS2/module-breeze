<?xml version="1.0"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd">
    <head>
        <remove src="mage/calendar.css"/>
        <remove src="mage/gallery/gallery.css"/>

        <!-- disable turbo cache since it's not working with knockout (compare sidebar) -->
        <meta name="turbo-cache-control" content="no-cache"/>
    </head>
    <body>
        <!-- <referenceContainer name="head.additional"> -->
        <referenceContainer name="before.body.end">
            <block class="Swissup\Breeze\Block\JsTranslations" name="breeze.translations">
                <arguments>
                    <argument name="cache_lifetime" xsi:type="number">864000</argument>
                </arguments>
            </block>
        </referenceContainer>

        <block class="Swissup\Breeze\Block\Js" name="breeze.js">
            <arguments>
                <argument name="cache_lifetime" xsi:type="number">864000</argument> <!-- 10 days -->
                <argument name="assets" xsi:type="array">
                    <item name="cash" xsi:type="string">Swissup_Breeze::js/lib/cash-8.1.0.min.js</item>
                    <!-- <item name="jquery" xsi:type="string">Swissup_Breeze::js/lib/jquery-3.5.1.slim.min.js</item> -->
                    <item name="superagent" xsi:type="string">Swissup_Breeze::js/lib/superagent-6.1.0.min.js</item>
                    <item name="cookie" xsi:type="string">Swissup_Breeze::js/lib/js.cookie-3.0.0-rc1.min.js</item>
                    <item name="underscore" xsi:type="string">Swissup_Breeze::js/lib/underscore-1.12.0.min.js</item>
                    <item name="knockout" xsi:type="string">Swissup_Breeze::js/lib/knockout-3.5.1.min.js</item>
                    <item name="turbo" xsi:type="array">
                        <item name="url" xsi:type="string">Swissup_Breeze::js/lib/turbo-7.0.0-beta4.min.js</item>
                        <item name="enabled" xsi:type="helper" helper="Swissup\Breeze\Helper\Data::isTurboEnabled"/>
                    </item>
                    <item name="breeze-fn" xsi:type="string">Swissup_Breeze::js/core/fn.js</item>
                    <item name="breeze-request" xsi:type="string">Swissup_Breeze::js/core/request.js</item>
                    <item name="breeze-translate" xsi:type="string">Swissup_Breeze::js/core/translate.js</item>
                    <item name="breeze-object" xsi:type="string">Swissup_Breeze::js/core/component/component.js</item>
                    <item name="breeze-widget" xsi:type="string">Swissup_Breeze::js/core/component/widget.js</item>
                    <item name="breeze-view" xsi:type="string">Swissup_Breeze::js/core/component/view.js</item>
                    <item name="breeze-cookie" xsi:type="string">Swissup_Breeze::js/core/cookie.js</item>
                    <item name="breeze-storage" xsi:type="string">Swissup_Breeze::js/core/storage.js</item>
                    <item name="breeze-sections" xsi:type="string">Swissup_Breeze::js/core/sections.js</item>
                    <item name="breeze-main" xsi:type="string">Swissup_Breeze::js/core/main.js</item>
                    <item name="breeze-common" xsi:type="string">Swissup_Breeze::js/common/common.js</item>
                    <item name="breeze-theme" xsi:type="string">Swissup_Breeze::js/common/theme.js</item>
                </argument>
                <argument name="bundles" xsi:type="array">
                    <item name="default" xsi:type="array">
                        <item name="active" xsi:type="boolean">true</item>
                        <item name="sort_order" xsi:type="number">10</item>
                        <item name="components" xsi:type="array">
                            <item name="Magento_Customer/js/customer-data" xsi:type="string">Swissup_Breeze/js/components/customerData</item>
                            <item name="Magento_PageCache/js/form-key-provider" xsi:type="string">Swissup_Breeze/js/components/formKey</item>
                            <item name="dataPost" xsi:type="string">Swissup_Breeze/js/components/dataPost</item>
                            <item name="menu" xsi:type="string">Swissup_Breeze/js/components/menu</item>
                            <item name="dropdown" xsi:type="string">Swissup_Breeze/js/components/dropdown</item>
                            <item name="collapsible" xsi:type="string">Swissup_Breeze/js/components/collapsible</item>
                            <item name="tabs" xsi:type="string">Swissup_Breeze/js/components/tabs</item>
                            <item name="accordion" xsi:type="string">Swissup_Breeze/js/components/accordion</item>
                            <item name="catalogAddToCart" xsi:type="string">Swissup_Breeze/js/components/catalogAddToCart</item>
                            <item name="productListToolbarForm" xsi:type="string">Swissup_Breeze/js/components/productListToolbarForm</item>

                            <!-- ViewModels -->
                            <item name="Magento_Customer/js/view/customer" xsi:type="string">Swissup_Breeze/js/components/view/customer</item>
                            <item name="Magento_Theme/js/view/messages" xsi:type="string">Swissup_Breeze/js/components/view/messages</item>
                            <item name="Magento_Catalog/js/view/compare-products" xsi:type="string">Swissup_Breeze/js/components/view/compareProducts</item>
                            <item name="Magento_Checkout/js/view/minicart" xsi:type="string">Swissup_Breeze/js/components/view/minicart</item>
                            <item name="Magento_Wishlist/js/view/wishlist" xsi:type="string">Swissup_Breeze/js/components/view/wishlist</item>
                        </item>
                    </item>
                    <item name="product" xsi:type="array">
                        <item name="sort_order" xsi:type="number">20</item>
                        <item name="components" xsi:type="array">
                            <item name="Magento_Catalog/js/validate-product" xsi:type="string">Swissup_Breeze/js/components/validateProduct</item>
                        </item>
                    </item>
                </argument>
            </arguments>
        </block>

        <!-- Remove unused blocks-->
        <referenceBlock name="cookie-status-check" remove="true"/>
        <referenceBlock name="js_cookies" remove="true"/>

        <!-- Change templates -->
        <referenceBlock name="cookie_config" template="Swissup_Breeze::theme/js/cookie.phtml"/>
        <referenceBlock name="customer.section.config" template="Swissup_Breeze::customer/js/section-config.phtml"/>
        <referenceBlock name="wishlist_sidebar" template="Swissup_Breeze::wishlist/sidebar.phtml"/>

        <referenceBlock name="minicart" template="Swissup_Breeze::checkout/minicart.phtml"/>

        <!-- Add ko templates -->
        <referenceContainer name="before.body.end">
            <block class="Magento\Framework\View\Element\Template" template="Swissup_Breeze::ko/shared/product-image.phtml"/>
        </referenceContainer>
    </body>
</page>
